<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 17 Machine learning supervisé et NLP | NLP avec r et en français - un Manuel synthétique</title>
  <meta name="description" content="Un manuel pratique de NLP en français" />
  <meta name="generator" content="bookdown 0.22.3 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 17 Machine learning supervisé et NLP | NLP avec r et en français - un Manuel synthétique" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Un manuel pratique de NLP en français" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 17 Machine learning supervisé et NLP | NLP avec r et en français - un Manuel synthétique" />
  
  <meta name="twitter:description" content="Un manuel pratique de NLP en français" />
  

<meta name="author" content="Sophie Balech, Julien Monnot, Christophe Benavent" />


<meta name="date" content="2021-12-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="topic.html"/>
<link rel="next" href="deep-learning.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-7EKDD8SVH6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-7EKDD8SVH6');
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">NLP en r et en français</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Préambule</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#cours-et-séminaires"><i class="fa fa-check"></i><b>1.1</b> Cours et séminaires</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#la-structure-du-livre"><i class="fa fa-check"></i><b>1.2</b> La structure du livre</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#les-jeux-de-données"><i class="fa fa-check"></i><b>1.3</b> Les jeux de données</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#les-ressources"><i class="fa fa-check"></i><b>1.4</b> Les ressources</a><ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#les-packages"><i class="fa fa-check"></i><b>1.4.1</b> Les packages</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#disponibilité"><i class="fa fa-check"></i><b>1.5</b> Disponibilité</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#une-réflexion-ancienne-et-un-nouveau-champ-méthodologique"><i class="fa fa-check"></i><b>2.1</b> Une réflexion ancienne et un nouveau champ méthodologique</a><ul>
<li class="chapter" data-level="2.1.1" data-path="intro.html"><a href="intro.html#langue-langage-et-texte-parole"><i class="fa fa-check"></i><b>2.1.1</b> Langue, langage et texte parole</a></li>
<li class="chapter" data-level="2.1.2" data-path="intro.html"><a href="intro.html#syntaxe-et-grammaire-générative"><i class="fa fa-check"></i><b>2.1.2</b> Syntaxe et grammaire générative</a></li>
<li class="chapter" data-level="2.1.3" data-path="intro.html"><a href="intro.html#sémantique-la-conception-distributionnelle"><i class="fa fa-check"></i><b>2.1.3</b> Sémantique : La conception distributionnelle</a></li>
<li class="chapter" data-level="2.1.4" data-path="intro.html"><a href="intro.html#lapproche-pragmatique-les-fonctions-et-acte-du-langage"><i class="fa fa-check"></i><b>2.1.4</b> L’approche pragmatique : les fonctions et acte du langage</a></li>
<li class="chapter" data-level="2.1.5" data-path="intro.html"><a href="intro.html#la-linguistique-computationnelle"><i class="fa fa-check"></i><b>2.1.5</b> La linguistique computationnelle</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#les-facteurs-de-développement-de-lusage-en-science-sociale"><i class="fa fa-check"></i><b>2.2</b> Les facteurs de développement de l’usage en science sociale</a><ul>
<li class="chapter" data-level="2.2.1" data-path="intro.html"><a href="intro.html#une-lingua-franca"><i class="fa fa-check"></i><b>2.2.1</b> Une lingua franca</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro.html"><a href="intro.html#la-multiplication-des-sources-de-données."><i class="fa fa-check"></i><b>2.2.2</b> La multiplication des sources de données.</a></li>
<li class="chapter" data-level="2.2.3" data-path="intro.html"><a href="intro.html#une-communauté"><i class="fa fa-check"></i><b>2.2.3</b> Une communauté</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#de-nouvelles-méthodologies-pour-les-sciences-sociales"><i class="fa fa-check"></i><b>2.3</b> De nouvelles méthodologies pour les sciences sociales</a><ul>
<li class="chapter" data-level="2.3.1" data-path="intro.html"><a href="intro.html#nouveaux-terrains"><i class="fa fa-check"></i><b>2.3.1</b> Nouveaux terrains :</a></li>
<li class="chapter" data-level="2.3.2" data-path="intro.html"><a href="intro.html#nouvelles-méthodes"><i class="fa fa-check"></i><b>2.3.2</b> Nouvelles méthodes :</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#un-nouvel-objet"><i class="fa fa-check"></i><b>2.4</b> Un nouvel objet :</a><ul>
<li class="chapter" data-level="2.4.1" data-path="intro.html"><a href="intro.html#sociologie-et-histoire"><i class="fa fa-check"></i><b>2.4.1</b> Sociologie et histoire</a></li>
<li class="chapter" data-level="2.4.2" data-path="intro.html"><a href="intro.html#psychologie"><i class="fa fa-check"></i><b>2.4.2</b> Psychologie</a></li>
<li class="chapter" data-level="2.4.3" data-path="intro.html"><a href="intro.html#management"><i class="fa fa-check"></i><b>2.4.3</b> Management</a></li>
<li class="chapter" data-level="2.4.4" data-path="intro.html"><a href="intro.html#economie"><i class="fa fa-check"></i><b>2.4.4</b> Economie</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#des-comptables-à-lindustrie-de-la-langue"><i class="fa fa-check"></i><b>2.5</b> Des comptables à l’industrie de la langue</a></li>
<li class="chapter" data-level="2.6" data-path="intro.html"><a href="intro.html#conclusion"><i class="fa fa-check"></i><b>2.6</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="la-diversité-et-la-nature-des-corpus.html"><a href="la-diversité-et-la-nature-des-corpus.html"><i class="fa fa-check"></i><b>3</b> La diversité et la nature des corpus</a><ul>
<li class="chapter" data-level="3.1" data-path="la-diversité-et-la-nature-des-corpus.html"><a href="la-diversité-et-la-nature-des-corpus.html#différents-types-de-corpus"><i class="fa fa-check"></i><b>3.1</b> Différents types de corpus</a></li>
<li class="chapter" data-level="3.2" data-path="la-diversité-et-la-nature-des-corpus.html"><a href="la-diversité-et-la-nature-des-corpus.html#problèmes-déchantillon"><i class="fa fa-check"></i><b>3.2</b> Problèmes d’échantillon</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="constitution-du-corpus.html"><a href="constitution-du-corpus.html"><i class="fa fa-check"></i><b>4</b> Constitution du corpus</a><ul>
<li class="chapter" data-level="4.1" data-path="constitution-du-corpus.html"><a href="constitution-du-corpus.html#la-gestion-des-documents-numériques"><i class="fa fa-check"></i><b>4.1</b> La gestion des documents numériques</a><ul>
<li class="chapter" data-level="4.1.1" data-path="constitution-du-corpus.html"><a href="constitution-du-corpus.html#extraire-du-texte-des-pdf"><i class="fa fa-check"></i><b>4.1.1</b> Extraire du texte des pdf</a></li>
<li class="chapter" data-level="4.1.2" data-path="constitution-du-corpus.html"><a href="constitution-du-corpus.html#la-numérisation-et-locr"><i class="fa fa-check"></i><b>4.1.2</b> La numérisation et l’OCR</a></li>
<li class="chapter" data-level="4.1.3" data-path="constitution-du-corpus.html"><a href="constitution-du-corpus.html#du-speech-au-texte"><i class="fa fa-check"></i><b>4.1.3</b> Du speech au texte</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="constitution-du-corpus.html"><a href="constitution-du-corpus.html#lexploitation-de-base-de-données-textuelles"><i class="fa fa-check"></i><b>4.2</b> L’exploitation de base de données textuelles</a><ul>
<li class="chapter" data-level="4.2.1" data-path="constitution-du-corpus.html"><a href="constitution-du-corpus.html#le-cas-europresse"><i class="fa fa-check"></i><b>4.2.1</b> le cas europresse</a></li>
<li class="chapter" data-level="4.2.2" data-path="constitution-du-corpus.html"><a href="constitution-du-corpus.html#jouer-avec-les-bases-bibliographiques"><i class="fa fa-check"></i><b>4.2.2</b> Jouer avec les bases bibliographiques</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="constitution-du-corpus.html"><a href="constitution-du-corpus.html#lire-le-web-scrapping"><i class="fa fa-check"></i><b>4.3</b> Lire le web : Scrapping</a><ul>
<li class="chapter" data-level="4.3.1" data-path="constitution-du-corpus.html"><a href="constitution-du-corpus.html#rvest-avec-r"><i class="fa fa-check"></i><b>4.3.1</b> rvest avec r</a></li>
<li class="chapter" data-level="4.3.2" data-path="constitution-du-corpus.html"><a href="constitution-du-corpus.html#des-problèmes-pratiques-juridiques-et-éthiques"><i class="fa fa-check"></i><b>4.3.2</b> Des problèmes pratiques, juridiques et éthiques</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="constitution-du-corpus.html"><a href="constitution-du-corpus.html#limportance-croissante-des-api"><i class="fa fa-check"></i><b>4.4</b> L’importance croissante des API</a><ul>
<li class="chapter" data-level="4.4.1" data-path="constitution-du-corpus.html"><a href="constitution-du-corpus.html#un-tour-dhorizon"><i class="fa fa-check"></i><b>4.4.1</b> Un tour d’horizon</a></li>
<li class="chapter" data-level="4.4.2" data-path="constitution-du-corpus.html"><a href="constitution-du-corpus.html#un-point-de-vue-plus-technique"><i class="fa fa-check"></i><b>4.4.2</b> un point de vue plus technique</a></li>
<li class="chapter" data-level="4.4.3" data-path="constitution-du-corpus.html"><a href="constitution-du-corpus.html#un-exemple-avec-rtweet"><i class="fa fa-check"></i><b>4.4.3</b> Un exemple avec Rtweet</a></li>
<li class="chapter" data-level="4.4.4" data-path="constitution-du-corpus.html"><a href="constitution-du-corpus.html#un-autre-exemple"><i class="fa fa-check"></i><b>4.4.4</b> Un autre exemple</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="constitution-du-corpus.html"><a href="constitution-du-corpus.html#conclusion-1"><i class="fa fa-check"></i><b>4.5</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="explorer-et-visualiser-le-corpus.html"><a href="explorer-et-visualiser-le-corpus.html"><i class="fa fa-check"></i><b>5</b> Explorer et visualiser le corpus</a><ul>
<li class="chapter" data-level="5.1" data-path="explorer-et-visualiser-le-corpus.html"><a href="explorer-et-visualiser-le-corpus.html#kwic"><i class="fa fa-check"></i><b>5.1</b> Kwic</a></li>
<li class="chapter" data-level="5.2" data-path="explorer-et-visualiser-le-corpus.html"><a href="explorer-et-visualiser-le-corpus.html#explorer-le-corpus"><i class="fa fa-check"></i><b>5.2</b> Explorer le corpus</a><ul>
<li class="chapter" data-level="5.2.1" data-path="explorer-et-visualiser-le-corpus.html"><a href="explorer-et-visualiser-le-corpus.html#reprendre-le-topic-de-revtools"><i class="fa fa-check"></i><b>5.2.1</b> reprendre le topic de revtools</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="préparation-des-données.html"><a href="préparation-des-données.html"><i class="fa fa-check"></i><b>6</b> Préparation des données</a><ul>
<li class="chapter" data-level="6.1" data-path="préparation-des-données.html"><a href="préparation-des-données.html#manipuler-des-chaines-de-caractères"><i class="fa fa-check"></i><b>6.1</b> Manipuler des chaines de caractères</a><ul>
<li class="chapter" data-level="6.1.1" data-path="préparation-des-données.html"><a href="préparation-des-données.html#les-opérations-sur-les-chaînes-de-caractères"><i class="fa fa-check"></i><b>6.1.1</b> Les opérations sur les chaînes de caractères</a></li>
<li class="chapter" data-level="6.1.2" data-path="préparation-des-données.html"><a href="préparation-des-données.html#la-technique-des-expressions-régulières-regex"><i class="fa fa-check"></i><b>6.1.2</b> La technique des expressions régulières (regex)</a></li>
<li class="chapter" data-level="6.1.3" data-path="préparation-des-données.html"><a href="préparation-des-données.html#un-fondement-profond-et-ancien"><i class="fa fa-check"></i><b>6.1.3</b> Un fondement profond et ancien</a></li>
<li class="chapter" data-level="6.1.4" data-path="préparation-des-données.html"><a href="préparation-des-données.html#des-applications-très-pratiques"><i class="fa fa-check"></i><b>6.1.4</b> Des applications très pratiques</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="préparation-des-données.html"><a href="préparation-des-données.html#nettoyer-le-texte"><i class="fa fa-check"></i><b>6.2</b> Nettoyer le texte</a></li>
<li class="chapter" data-level="6.3" data-path="préparation-des-données.html"><a href="préparation-des-données.html#corriger-le-texte"><i class="fa fa-check"></i><b>6.3</b> Corriger le texte</a><ul>
<li class="chapter" data-level="6.3.1" data-path="préparation-des-données.html"><a href="préparation-des-données.html#la-correction-orthographique-automatique"><i class="fa fa-check"></i><b>6.3.1</b> La correction orthographique automatique</a></li>
<li class="chapter" data-level="6.3.2" data-path="préparation-des-données.html"><a href="préparation-des-données.html#analyse-ciblée-par-les-regex"><i class="fa fa-check"></i><b>6.3.2</b> Analyse ciblée par les regex</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="préparation-des-données.html"><a href="préparation-des-données.html#identifier-les-sources"><i class="fa fa-check"></i><b>6.4</b> Identifier les sources</a><ul>
<li class="chapter" data-level="6.4.1" data-path="préparation-des-données.html"><a href="préparation-des-données.html#identifier-la-langue"><i class="fa fa-check"></i><b>6.4.1</b> Identifier la langue</a></li>
<li class="chapter" data-level="6.4.2" data-path="préparation-des-données.html"><a href="préparation-des-données.html#identifier-les-plagiats-et-réutilisations"><i class="fa fa-check"></i><b>6.4.2</b> Identifier les plagiats et réutilisations</a></li>
<li class="chapter" data-level="6.4.3" data-path="préparation-des-données.html"><a href="préparation-des-données.html#identifier-les-fakes"><i class="fa fa-check"></i><b>6.4.3</b> Identifier les fakes</a></li>
<li class="chapter" data-level="6.4.4" data-path="préparation-des-données.html"><a href="préparation-des-données.html#identifier-les-trolls"><i class="fa fa-check"></i><b>6.4.4</b> Identifier les trolls</a></li>
<li class="chapter" data-level="6.4.5" data-path="préparation-des-données.html"><a href="préparation-des-données.html#identifier-les-bots"><i class="fa fa-check"></i><b>6.4.5</b> Identifier les bots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="une-première-analyse-quantitative.html"><a href="une-première-analyse-quantitative.html"><i class="fa fa-check"></i><b>7</b> Une première analyse quantitative</a><ul>
<li class="chapter" data-level="7.1" data-path="une-première-analyse-quantitative.html"><a href="une-première-analyse-quantitative.html#comptons-les-mots"><i class="fa fa-check"></i><b>7.1</b> Comptons les mots</a></li>
<li class="chapter" data-level="7.2" data-path="une-première-analyse-quantitative.html"><a href="une-première-analyse-quantitative.html#la-production-dans-le-temps"><i class="fa fa-check"></i><b>7.2</b> la production dans le temps</a></li>
<li class="chapter" data-level="7.3" data-path="une-première-analyse-quantitative.html"><a href="une-première-analyse-quantitative.html#lisibilité-et-complexité-lexicale"><i class="fa fa-check"></i><b>7.3</b> Lisibilité et complexité lexicale</a><ul>
<li class="chapter" data-level="7.3.1" data-path="une-première-analyse-quantitative.html"><a href="une-première-analyse-quantitative.html#les-indices-de-lisibilité"><i class="fa fa-check"></i><b>7.3.1</b> Les indices de lisibilité</a></li>
<li class="chapter" data-level="7.3.2" data-path="une-première-analyse-quantitative.html"><a href="une-première-analyse-quantitative.html#les-indices-de-complexité-lexicale"><i class="fa fa-check"></i><b>7.3.2</b> Les indices de complexité lexicale</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="une-première-analyse-quantitative.html"><a href="une-première-analyse-quantitative.html#comptons-les-mots-1"><i class="fa fa-check"></i><b>7.4</b> Comptons les mots</a><ul>
<li class="chapter" data-level="7.4.1" data-path="une-première-analyse-quantitative.html"><a href="une-première-analyse-quantitative.html#les-nuages-de-mots"><i class="fa fa-check"></i><b>7.4.1</b> Les nuages de mots</a></li>
<li class="chapter" data-level="7.4.2" data-path="une-première-analyse-quantitative.html"><a href="une-première-analyse-quantitative.html#des-lollyplots"><i class="fa fa-check"></i><b>7.4.2</b> Des lollyplots</a></li>
<li class="chapter" data-level="7.4.3" data-path="une-première-analyse-quantitative.html"><a href="une-première-analyse-quantitative.html#la-mesure-de-la-concentration-des-termes"><i class="fa fa-check"></i><b>7.4.3</b> La mesure de la concentration des termes</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="une-première-analyse-quantitative.html"><a href="une-première-analyse-quantitative.html#conclusion-2"><i class="fa fa-check"></i><b>7.5</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="analyse-du-sentiment.html"><a href="analyse-du-sentiment.html"><i class="fa fa-check"></i><b>8</b> Analyse du sentiment</a><ul>
<li class="chapter" data-level="8.1" data-path="analyse-du-sentiment.html"><a href="analyse-du-sentiment.html#un-exemple-avec-syuzhet"><i class="fa fa-check"></i><b>8.1</b> Un exemple avec syuzhet</a><ul>
<li class="chapter" data-level="8.1.1" data-path="analyse-du-sentiment.html"><a href="analyse-du-sentiment.html#valence-et-expression"><i class="fa fa-check"></i><b>8.1.1</b> Valence et expression</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="analyse-du-sentiment.html"><a href="analyse-du-sentiment.html#la-généralisation-par-le-liwc"><i class="fa fa-check"></i><b>8.2</b> La généralisation par le Liwc</a></li>
<li class="chapter" data-level="8.3" data-path="analyse-du-sentiment.html"><a href="analyse-du-sentiment.html#encore-dautres-généralisations"><i class="fa fa-check"></i><b>8.3</b> Encore d’autres généralisations</a></li>
<li class="chapter" data-level="8.4" data-path="analyse-du-sentiment.html"><a href="analyse-du-sentiment.html#construire-son-propre-dictionnaire"><i class="fa fa-check"></i><b>8.4</b> construire son propre dictionnaire</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="token.html"><a href="token.html"><i class="fa fa-check"></i><b>9</b> Tokenisation</a><ul>
<li class="chapter" data-level="9.1" data-path="token.html"><a href="token.html#objectifs-du-chapitre"><i class="fa fa-check"></i><b>9.1</b> <em>Objectifs du chapitre</em></a></li>
<li class="chapter" data-level="9.2" data-path="token.html"><a href="token.html#les-outils"><i class="fa fa-check"></i><b>9.2</b> Les outils</a></li>
<li class="chapter" data-level="9.3" data-path="token.html"><a href="token.html#introduction"><i class="fa fa-check"></i><b>9.3</b> Introduction</a></li>
<li class="chapter" data-level="9.4" data-path="token.html"><a href="token.html#tokeniser-un-corpus"><i class="fa fa-check"></i><b>9.4</b> Tokeniser un corpus</a><ul>
<li class="chapter" data-level="9.4.1" data-path="token.html"><a href="token.html#les-lettres"><i class="fa fa-check"></i><b>9.4.1</b> Les lettres</a></li>
<li class="chapter" data-level="9.4.2" data-path="token.html"><a href="token.html#les-mots"><i class="fa fa-check"></i><b>9.4.2</b> Les mots</a></li>
<li class="chapter" data-level="9.4.3" data-path="token.html"><a href="token.html#les-phrases"><i class="fa fa-check"></i><b>9.4.3</b> Les phrases</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="token.html"><a href="token.html#n-grammes"><i class="fa fa-check"></i><b>9.5</b> N-grammes</a><ul>
<li class="chapter" data-level="9.5.1" data-path="token.html"><a href="token.html#propriétés-statistiques-des-n-grammes"><i class="fa fa-check"></i><b>9.5.1</b> Propriétés statistiques des n-grammes</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="token.html"><a href="token.html#choisir-des-n-grammes-pertinents"><i class="fa fa-check"></i><b>9.6</b> Choisir des n-grammes pertinents</a><ul>
<li class="chapter" data-level="9.6.1" data-path="token.html"><a href="token.html#créer-les-tokens-avec-quanteda"><i class="fa fa-check"></i><b>9.6.1</b> Créer les <em>tokens</em> avec ‘quanteda’</a></li>
<li class="chapter" data-level="9.6.2" data-path="token.html"><a href="token.html#identifier-les-noms-propres"><i class="fa fa-check"></i><b>9.6.2</b> Identifier les noms propres</a></li>
<li class="chapter" data-level="9.6.3" data-path="token.html"><a href="token.html#composer-des-tokens-à-partir-dexpressions-multi-mots"><i class="fa fa-check"></i><b>9.6.3</b> Composer des <em>tokens</em> à partir d’expressions multi-mots</a></li>
<li class="chapter" data-level="9.6.4" data-path="token.html"><a href="token.html#identifier-les-autres-concepts"><i class="fa fa-check"></i><b>9.6.4</b> Identifier les autres concepts</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="token.html"><a href="token.html#conclusion-3"><i class="fa fa-check"></i><b>9.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="annotations-lexicales-et-syntaxiques.html"><a href="annotations-lexicales-et-syntaxiques.html"><i class="fa fa-check"></i><b>10</b> Annotations lexicales et syntaxiques</a><ul>
<li class="chapter" data-level="10.1" data-path="annotations-lexicales-et-syntaxiques.html"><a href="annotations-lexicales-et-syntaxiques.html#stemmatisation-lemmatisation-et-synonymisation"><i class="fa fa-check"></i><b>10.1</b> Stemmatisation, lemmatisation et synonymisation</a><ul>
<li class="chapter" data-level="10.1.1" data-path="annotations-lexicales-et-syntaxiques.html"><a href="annotations-lexicales-et-syntaxiques.html#la-stemmatisation-et-la-lemmatisation"><i class="fa fa-check"></i><b>10.1.1</b> la stemmatisation et la lemmatisation</a></li>
<li class="chapter" data-level="10.1.2" data-path="annotations-lexicales-et-syntaxiques.html"><a href="annotations-lexicales-et-syntaxiques.html#synonymisation"><i class="fa fa-check"></i><b>10.1.2</b> Synonymisation</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="annotations-lexicales-et-syntaxiques.html"><a href="annotations-lexicales-et-syntaxiques.html#part-of-speech-pos"><i class="fa fa-check"></i><b>10.2</b> Part of Speech (POS)</a></li>
<li class="chapter" data-level="10.3" data-path="annotations-lexicales-et-syntaxiques.html"><a href="annotations-lexicales-et-syntaxiques.html#dépendances-syntaxiques"><i class="fa fa-check"></i><b>10.3</b> Dépendances syntaxiques</a><ul>
<li class="chapter" data-level="10.3.1" data-path="annotations-lexicales-et-syntaxiques.html"><a href="annotations-lexicales-et-syntaxiques.html#arbre-syntaxique"><i class="fa fa-check"></i><b>10.3.1</b> Arbre syntaxique</a></li>
<li class="chapter" data-level="10.3.2" data-path="annotations-lexicales-et-syntaxiques.html"><a href="annotations-lexicales-et-syntaxiques.html#vers-des-application-plus-générale"><i class="fa fa-check"></i><b>10.3.2</b> Vers des application plus générale</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="annotations-lexicales-et-syntaxiques.html"><a href="annotations-lexicales-et-syntaxiques.html#reconnaissance-dentités-nommées"><i class="fa fa-check"></i><b>10.4</b> reconnaissance d’entités nommées</a></li>
<li class="chapter" data-level="10.5" data-path="annotations-lexicales-et-syntaxiques.html"><a href="annotations-lexicales-et-syntaxiques.html#co-reférence"><i class="fa fa-check"></i><b>10.5</b> co-reférence</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="gestion-des-données-textuelles.html"><a href="gestion-des-données-textuelles.html"><i class="fa fa-check"></i><b>11</b> Gestion des données textuelles</a><ul>
<li class="chapter" data-level="11.1" data-path="gestion-des-données-textuelles.html"><a href="gestion-des-données-textuelles.html#jouer-avec-les-tokens"><i class="fa fa-check"></i><b>11.1</b> Jouer avec les tokens</a></li>
<li class="chapter" data-level="11.2" data-path="gestion-des-données-textuelles.html"><a href="gestion-des-données-textuelles.html#les-dtm"><i class="fa fa-check"></i><b>11.2</b> Les DTM</a><ul>
<li class="chapter" data-level="11.2.1" data-path="gestion-des-données-textuelles.html"><a href="gestion-des-données-textuelles.html#codage"><i class="fa fa-check"></i><b>11.2.1</b> Codage</a></li>
<li class="chapter" data-level="11.2.2" data-path="gestion-des-données-textuelles.html"><a href="gestion-des-données-textuelles.html#des-représentations-tidy"><i class="fa fa-check"></i><b>11.2.2</b> Des représentations tidy</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="gestion-des-données-textuelles.html"><a href="gestion-des-données-textuelles.html#les-ctm"><i class="fa fa-check"></i><b>11.3</b> Les ctm</a><ul>
<li class="chapter" data-level="11.3.1" data-path="gestion-des-données-textuelles.html"><a href="gestion-des-données-textuelles.html#cooccurence"><i class="fa fa-check"></i><b>11.3.1</b> cooccurence</a></li>
<li class="chapter" data-level="11.3.2" data-path="gestion-des-données-textuelles.html"><a href="gestion-des-données-textuelles.html#une-application-à-lanalyse-des-similarités"><i class="fa fa-check"></i><b>11.3.2</b> une application à l’analyse des similarités</a></li>
<li class="chapter" data-level="11.3.3" data-path="gestion-des-données-textuelles.html"><a href="gestion-des-données-textuelles.html#une-application-au-clustering"><i class="fa fa-check"></i><b>11.3.3</b> une application au clustering</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="le-retour-des-méthodes-factorielles.html"><a href="le-retour-des-méthodes-factorielles.html"><i class="fa fa-check"></i><b>12</b> Le retour des méthodes factorielles</a><ul>
<li class="chapter" data-level="12.1" data-path="le-retour-des-méthodes-factorielles.html"><a href="le-retour-des-méthodes-factorielles.html#objectifs-du-chapitre-1"><i class="fa fa-check"></i><b>12.1</b> <em>Objectifs du chapitre</em></a></li>
<li class="chapter" data-level="12.2" data-path="le-retour-des-méthodes-factorielles.html"><a href="le-retour-des-méthodes-factorielles.html#les-outils-1"><i class="fa fa-check"></i><b>12.2</b> Les outils</a></li>
<li class="chapter" data-level="12.3" data-path="le-retour-des-méthodes-factorielles.html"><a href="le-retour-des-méthodes-factorielles.html#introduction-1"><i class="fa fa-check"></i><b>12.3</b> Introduction</a></li>
<li class="chapter" data-level="12.4" data-path="le-retour-des-méthodes-factorielles.html"><a href="le-retour-des-méthodes-factorielles.html#méthodes-données"><i class="fa fa-check"></i><b>12.4</b> Méthodes &amp; Données</a><ul>
<li class="chapter" data-level="12.4.1" data-path="le-retour-des-méthodes-factorielles.html"><a href="le-retour-des-méthodes-factorielles.html#principes-généraux"><i class="fa fa-check"></i><b>12.4.1</b> Principes généraux</a></li>
<li class="chapter" data-level="12.4.2" data-path="le-retour-des-méthodes-factorielles.html"><a href="le-retour-des-méthodes-factorielles.html#données"><i class="fa fa-check"></i><b>12.4.2</b> Données</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="le-retour-des-méthodes-factorielles.html"><a href="le-retour-des-méthodes-factorielles.html#analyse-par-composantes-principales-acppca"><i class="fa fa-check"></i><b>12.5</b> Analyse par Composantes Principales (ACP/PCA)</a></li>
<li class="chapter" data-level="12.6" data-path="le-retour-des-méthodes-factorielles.html"><a href="le-retour-des-méthodes-factorielles.html#analyse-des-correspondances"><i class="fa fa-check"></i><b>12.6</b> Analyse des Correspondances</a><ul>
<li class="chapter" data-level="12.6.1" data-path="le-retour-des-méthodes-factorielles.html"><a href="le-retour-des-méthodes-factorielles.html#table-de-contingence"><i class="fa fa-check"></i><b>12.6.1</b> Table de contingence</a></li>
<li class="chapter" data-level="12.6.2" data-path="le-retour-des-méthodes-factorielles.html"><a href="le-retour-des-méthodes-factorielles.html#modèle"><i class="fa fa-check"></i><b>12.6.2</b> Modèle</a></li>
<li class="chapter" data-level="12.6.3" data-path="le-retour-des-méthodes-factorielles.html"><a href="le-retour-des-méthodes-factorielles.html#explor"><i class="fa fa-check"></i><b>12.6.3</b> explor</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="le-retour-des-méthodes-factorielles.html"><a href="le-retour-des-méthodes-factorielles.html#classification-hiérarchique"><i class="fa fa-check"></i><b>12.7</b> Classification Hiérarchique</a><ul>
<li class="chapter" data-level="12.7.1" data-path="le-retour-des-méthodes-factorielles.html"><a href="le-retour-des-méthodes-factorielles.html#classification-hiérarchique-ascendante"><i class="fa fa-check"></i><b>12.7.1</b> Classification Hiérarchique Ascendante</a></li>
<li class="chapter" data-level="12.7.2" data-path="le-retour-des-méthodes-factorielles.html"><a href="le-retour-des-méthodes-factorielles.html#classification-hiérarchique-ascendante-double"><i class="fa fa-check"></i><b>12.7.2</b> Classification Hiérarchique Ascendante Double</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="le-retour-des-méthodes-factorielles.html"><a href="le-retour-des-méthodes-factorielles.html#classification-hiérarchique-descendante-wordfish"><i class="fa fa-check"></i><b>12.8</b> Classification Hiérarchique Descendante : Wordfish</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="réseaux-sémantiques.html"><a href="réseaux-sémantiques.html"><i class="fa fa-check"></i><b>13</b> Réseaux sémantiques</a><ul>
<li class="chapter" data-level="13.1" data-path="réseaux-sémantiques.html"><a href="réseaux-sémantiques.html#des-analyses-de-proximités"><i class="fa fa-check"></i><b>13.1</b> Des analyses de proximités</a><ul>
<li class="chapter" data-level="13.1.1" data-path="réseaux-sémantiques.html"><a href="réseaux-sémantiques.html#les-classiques"><i class="fa fa-check"></i><b>13.1.1</b> les classiques</a></li>
<li class="chapter" data-level="13.1.2" data-path="réseaux-sémantiques.html"><a href="réseaux-sémantiques.html#modèles-de-force"><i class="fa fa-check"></i><b>13.1.2</b> modèles de force</a></li>
<li class="chapter" data-level="13.1.3" data-path="réseaux-sémantiques.html"><a href="réseaux-sémantiques.html#tsne"><i class="fa fa-check"></i><b>13.1.3</b> tsne</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="réseaux-sémantiques.html"><a href="réseaux-sémantiques.html#igraph-et-les-cartes-sémantiques"><i class="fa fa-check"></i><b>13.2</b> igraph et les cartes sémantiques</a><ul>
<li class="chapter" data-level="13.2.1" data-path="réseaux-sémantiques.html"><a href="réseaux-sémantiques.html#gérer-les-liens"><i class="fa fa-check"></i><b>13.2.1</b> gérer les liens</a></li>
<li class="chapter" data-level="13.2.2" data-path="réseaux-sémantiques.html"><a href="réseaux-sémantiques.html#gérer-les-noeuds"><i class="fa fa-check"></i><b>13.2.2</b> gérer les noeuds</a></li>
<li class="chapter" data-level="13.2.3" data-path="réseaux-sémantiques.html"><a href="réseaux-sémantiques.html#gérer-les-labels"><i class="fa fa-check"></i><b>13.2.3</b> gérer les labels</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="réseaux-sémantiques.html"><a href="réseaux-sémantiques.html#propriétés-des-graphes-et-détection-de-communauté"><i class="fa fa-check"></i><b>13.3</b> propriétés des graphes et détection de communauté</a></li>
<li class="chapter" data-level="13.4" data-path="réseaux-sémantiques.html"><a href="réseaux-sémantiques.html#la-question-du-temps"><i class="fa fa-check"></i><b>13.4</b> la question du temps</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="analyse-sémantique-latente-asllsa.html"><a href="analyse-sémantique-latente-asllsa.html"><i class="fa fa-check"></i><b>14</b> Analyse Sémantique Latente (ASL/LSA)</a><ul>
<li class="chapter" data-level="14.0.1" data-path="analyse-sémantique-latente-asllsa.html"><a href="analyse-sémantique-latente-asllsa.html#non-negative-matrix-factorization"><i class="fa fa-check"></i><b>14.0.1</b> Non-negative Matrix Factorization</a></li>
<li class="chapter" data-level="14.1" data-path="analyse-sémantique-latente-asllsa.html"><a href="analyse-sémantique-latente-asllsa.html#conclusion-4"><i class="fa fa-check"></i><b>14.1</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="vectorisation-du-corpus.html"><a href="vectorisation-du-corpus.html"><i class="fa fa-check"></i><b>15</b> Vectorisation du corpus</a><ul>
<li class="chapter" data-level="15.1" data-path="vectorisation-du-corpus.html"><a href="vectorisation-du-corpus.html#application-avec-word2vec"><i class="fa fa-check"></i><b>15.1</b> Application avec Word2vec</a><ul>
<li class="chapter" data-level="15.1.1" data-path="vectorisation-du-corpus.html"><a href="vectorisation-du-corpus.html#préparer-et-annoter-grammaticalement-les-données"><i class="fa fa-check"></i><b>15.1.1</b> Préparer et annoter grammaticalement les données</a></li>
<li class="chapter" data-level="15.1.2" data-path="vectorisation-du-corpus.html"><a href="vectorisation-du-corpus.html#wordvectors-au-travail"><i class="fa fa-check"></i><b>15.1.2</b> WordVectors au travail</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="vectorisation-du-corpus.html"><a href="vectorisation-du-corpus.html#exploiter-le-modèle"><i class="fa fa-check"></i><b>15.2</b> Exploiter le modèle</a></li>
<li class="chapter" data-level="15.3" data-path="vectorisation-du-corpus.html"><a href="vectorisation-du-corpus.html#un-clustering-et-une-projection-tsne"><i class="fa fa-check"></i><b>15.3</b> Un clustering et une projection tsne</a></li>
<li class="chapter" data-level="15.4" data-path="vectorisation-du-corpus.html"><a href="vectorisation-du-corpus.html#les-perspectives"><i class="fa fa-check"></i><b>15.4</b> les perspectives</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="topic.html"><a href="topic.html"><i class="fa fa-check"></i><b>16</b> Topic Analysis</a><ul>
<li class="chapter" data-level="16.1" data-path="topic.html"><a href="topic.html#objectifs-du-chapitre-2"><i class="fa fa-check"></i><b>16.1</b> <em>Objectifs du chapitre</em></a></li>
<li class="chapter" data-level="16.2" data-path="topic.html"><a href="topic.html#les-outils-2"><i class="fa fa-check"></i><b>16.2</b> Les outils</a></li>
<li class="chapter" data-level="16.3" data-path="topic.html"><a href="topic.html#introduction-2"><i class="fa fa-check"></i><b>16.3</b> Introduction</a><ul>
<li class="chapter" data-level="16.3.1" data-path="topic.html"><a href="topic.html#latent-dirichlet-allocation-le-modèle-original-de-blei"><i class="fa fa-check"></i><b>16.3.1</b> Latent Dirichlet Allocation : Le modèle original de Blei</a></li>
<li class="chapter" data-level="16.3.2" data-path="topic.html"><a href="topic.html#structural-topic-modeling"><i class="fa fa-check"></i><b>16.3.2</b> Structural Topic Modeling</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="topic.html"><a href="topic.html#lda-une-application-aux-commentaires-trip-advisor"><i class="fa fa-check"></i><b>16.4</b> LDA : Une application aux commentaires trip advisor</a><ul>
<li class="chapter" data-level="16.4.1" data-path="topic.html"><a href="topic.html#la-détermination-du-nombre-optimal-de-topics"><i class="fa fa-check"></i><b>16.4.1</b> La détermination du nombre optimal de topics</a></li>
<li class="chapter" data-level="16.4.2" data-path="topic.html"><a href="topic.html#lda-theory-driven"><i class="fa fa-check"></i><b>16.4.2</b> LDA <em>theory driven</em></a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="topic.html"><a href="topic.html#stm"><i class="fa fa-check"></i><b>16.5</b> STM</a><ul>
<li class="chapter" data-level="16.5.1" data-path="topic.html"><a href="topic.html#préparation-des-données-1"><i class="fa fa-check"></i><b>16.5.1</b> Préparation des données</a></li>
<li class="chapter" data-level="16.5.2" data-path="topic.html"><a href="topic.html#identification-du-nombre-de-topics-optimal"><i class="fa fa-check"></i><b>16.5.2</b> Identification du nombre de <em>topics</em> optimal</a></li>
</ul></li>
<li class="chapter" data-level="16.6" data-path="topic.html"><a href="topic.html#interprétation-du-modèle-retenu"><i class="fa fa-check"></i><b>16.6</b> Interprétation du modèle retenu</a><ul>
<li class="chapter" data-level="16.6.1" data-path="topic.html"><a href="topic.html#le-modèle-retenu"><i class="fa fa-check"></i><b>16.6.1</b> Le modèle retenu</a></li>
<li class="chapter" data-level="16.6.2" data-path="topic.html"><a href="topic.html#corrélation-entre-les-topics"><i class="fa fa-check"></i><b>16.6.2</b> Corrélation entre les <em>topics</em></a></li>
</ul></li>
<li class="chapter" data-level="16.7" data-path="topic.html"><a href="topic.html#conclusion-5"><i class="fa fa-check"></i><b>16.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="machine-learning-supervisé-et-nlp.html"><a href="machine-learning-supervisé-et-nlp.html"><i class="fa fa-check"></i><b>17</b> Machine learning supervisé et NLP</a><ul>
<li class="chapter" data-level="17.1" data-path="machine-learning-supervisé-et-nlp.html"><a href="machine-learning-supervisé-et-nlp.html#le-principe-et-ses-applications"><i class="fa fa-check"></i><b>17.1</b> Le principe et ses applications</a></li>
<li class="chapter" data-level="17.2" data-path="machine-learning-supervisé-et-nlp.html"><a href="machine-learning-supervisé-et-nlp.html#une-première-application"><i class="fa fa-check"></i><b>17.2</b> Une première application</a><ul>
<li class="chapter" data-level="17.2.1" data-path="machine-learning-supervisé-et-nlp.html"><a href="machine-learning-supervisé-et-nlp.html#constituer-le-dataset"><i class="fa fa-check"></i><b>17.2.1</b> Constituer le dataset</a></li>
<li class="chapter" data-level="17.2.2" data-path="machine-learning-supervisé-et-nlp.html"><a href="machine-learning-supervisé-et-nlp.html#on-va-nettoyer-le-texte"><i class="fa fa-check"></i><b>17.2.2</b> On va nettoyer le texte</a></li>
<li class="chapter" data-level="17.2.3" data-path="machine-learning-supervisé-et-nlp.html"><a href="machine-learning-supervisé-et-nlp.html#caret-sur-la-scène"><i class="fa fa-check"></i><b>17.2.3</b> caret sur la scène</a></li>
<li class="chapter" data-level="17.2.4" data-path="machine-learning-supervisé-et-nlp.html"><a href="machine-learning-supervisé-et-nlp.html#un-modèle-naive-bayes"><i class="fa fa-check"></i><b>17.2.4</b> Un modèle naive bayes</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="machine-learning-supervisé-et-nlp.html"><a href="machine-learning-supervisé-et-nlp.html#passons-à-un-réseau-de-neurones-et-un-rf"><i class="fa fa-check"></i><b>17.3</b> Passons à un réseau de neurones et un RF</a><ul>
<li class="chapter" data-level="17.3.1" data-path="machine-learning-supervisé-et-nlp.html"><a href="machine-learning-supervisé-et-nlp.html#neuralnetwook"><i class="fa fa-check"></i><b>17.3.1</b> neuralnetwook</a></li>
<li class="chapter" data-level="17.3.2" data-path="machine-learning-supervisé-et-nlp.html"><a href="machine-learning-supervisé-et-nlp.html#multilayer"><i class="fa fa-check"></i><b>17.3.2</b> multilayer</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="machine-learning-supervisé-et-nlp.html"><a href="machine-learning-supervisé-et-nlp.html#comparons-les-modèles"><i class="fa fa-check"></i><b>17.4</b> Comparons les modèles</a><ul>
<li class="chapter" data-level="17.4.1" data-path="machine-learning-supervisé-et-nlp.html"><a href="machine-learning-supervisé-et-nlp.html#une-analyse-plus-précise-de-la-performance"><i class="fa fa-check"></i><b>17.4.1</b> Une analyse plus précise de la performance</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="machine-learning-supervisé-et-nlp.html"><a href="machine-learning-supervisé-et-nlp.html#mais-il-faut-expliquer"><i class="fa fa-check"></i><b>17.5</b> Mais il faut expliquer</a></li>
<li class="chapter" data-level="17.6" data-path="machine-learning-supervisé-et-nlp.html"><a href="machine-learning-supervisé-et-nlp.html#pour-finir-un-exercice-de-fine-tuning"><i class="fa fa-check"></i><b>17.6</b> Pour finir un exercice de fine tuning</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="deep-learning.html"><a href="deep-learning.html"><i class="fa fa-check"></i><b>18</b> Deep Learning</a><ul>
<li class="chapter" data-level="18.1" data-path="deep-learning.html"><a href="deep-learning.html#lenvironnement-keras"><i class="fa fa-check"></i><b>18.1</b> L’environnement keras</a><ul>
<li class="chapter" data-level="18.1.1" data-path="deep-learning.html"><a href="deep-learning.html#les-fonctions-principales"><i class="fa fa-check"></i><b>18.1.1</b> Les fonctions principales</a></li>
<li class="chapter" data-level="18.1.2" data-path="deep-learning.html"><a href="deep-learning.html#un-premier-exemple"><i class="fa fa-check"></i><b>18.1.2</b> Un premier exemple</a></li>
<li class="chapter" data-level="18.1.3" data-path="deep-learning.html"><a href="deep-learning.html#un-deuxième-exemple"><i class="fa fa-check"></i><b>18.1.3</b> Un deuxième exemple</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="deep-learning.html"><a href="deep-learning.html#les-architectures-du-texte-rnn-ltsm-transformer-et-reformer"><i class="fa fa-check"></i><b>18.2</b> Les architectures du texte : RNN, LTSM, Transformer et Reformer</a><ul>
<li class="chapter" data-level="18.2.1" data-path="deep-learning.html"><a href="deep-learning.html#rnn"><i class="fa fa-check"></i><b>18.2.1</b> rnn</a></li>
<li class="chapter" data-level="18.2.2" data-path="deep-learning.html"><a href="deep-learning.html#ltsm"><i class="fa fa-check"></i><b>18.2.2</b> ltsm</a></li>
<li class="chapter" data-level="18.2.3" data-path="deep-learning.html"><a href="deep-learning.html#transformer"><i class="fa fa-check"></i><b>18.2.3</b> transformer</a></li>
<li class="chapter" data-level="18.2.4" data-path="deep-learning.html"><a href="deep-learning.html#reformer"><i class="fa fa-check"></i><b>18.2.4</b> reformer</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="deep-learning.html"><a href="deep-learning.html#les-cas-dapplications-remarquables"><i class="fa fa-check"></i><b>18.3</b> Les cas d’applications remarquables</a><ul>
<li class="chapter" data-level="18.3.1" data-path="deep-learning.html"><a href="deep-learning.html#detection-dintention"><i class="fa fa-check"></i><b>18.3.1</b> Detection d’intention</a></li>
<li class="chapter" data-level="18.3.2" data-path="deep-learning.html"><a href="deep-learning.html#détection-de-toxicité-des-contenus"><i class="fa fa-check"></i><b>18.3.2</b> détection de toxicité des contenus</a></li>
<li class="chapter" data-level="18.3.3" data-path="deep-learning.html"><a href="deep-learning.html#la-detection-des-trolls"><i class="fa fa-check"></i><b>18.3.3</b> la detection des trolls</a></li>
<li class="chapter" data-level="18.3.4" data-path="deep-learning.html"><a href="deep-learning.html#détection-des-sophismes-et-autres-fallacies"><i class="fa fa-check"></i><b>18.3.4</b> détection des sophismes et autres fallacies</a></li>
<li class="chapter" data-level="18.3.5" data-path="deep-learning.html"><a href="deep-learning.html#la-détection-du-sarcasme-et-de-lironie"><i class="fa fa-check"></i><b>18.3.5</b> La détection du sarcasme et de l’ironie</a></li>
<li class="chapter" data-level="18.3.6" data-path="deep-learning.html"><a href="deep-learning.html#lextraction-darguments"><i class="fa fa-check"></i><b>18.3.6</b> L’extraction d’arguments</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="modèles-génératifs.html"><a href="modèles-génératifs.html"><i class="fa fa-check"></i><b>19</b> Modèles génératifs</a><ul>
<li class="chapter" data-level="19.1" data-path="modèles-génératifs.html"><a href="modèles-génératifs.html#simples-models"><i class="fa fa-check"></i><b>19.1</b> simples models</a><ul>
<li class="chapter" data-level="19.1.1" data-path="modèles-génératifs.html"><a href="modèles-génératifs.html#naives-bayes"><i class="fa fa-check"></i><b>19.1.1</b> Naives bayes</a></li>
<li class="chapter" data-level="19.1.2" data-path="modèles-génératifs.html"><a href="modèles-génératifs.html#elastic-net"><i class="fa fa-check"></i><b>19.1.2</b> elastic net</a></li>
<li class="chapter" data-level="19.1.3" data-path="modèles-génératifs.html"><a href="modèles-génératifs.html#rf"><i class="fa fa-check"></i><b>19.1.3</b> RF</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="modèles-génératifs.html"><a href="modèles-génératifs.html#art-of-featuring"><i class="fa fa-check"></i><b>19.2</b> art of featuring</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="20" data-path="annexes-quelques-problèmes-très-techniques.html"><a href="annexes-quelques-problèmes-très-techniques.html"><i class="fa fa-check"></i><b>20</b> Annexes : quelques problèmes très techniques</a><ul>
<li class="chapter" data-level="20.1" data-path="annexes-quelques-problèmes-très-techniques.html"><a href="annexes-quelques-problèmes-très-techniques.html#la-question-de-lencodage"><i class="fa fa-check"></i><b>20.1</b> La question de l’encodage</a></li>
<li class="chapter" data-level="20.2" data-path="annexes-quelques-problèmes-très-techniques.html"><a href="annexes-quelques-problèmes-très-techniques.html#jouer-avec-les-formats-de-données"><i class="fa fa-check"></i><b>20.2</b> Jouer avec les formats de données</a><ul>
<li class="chapter" data-level="20.2.1" data-path="annexes-quelques-problèmes-très-techniques.html"><a href="annexes-quelques-problèmes-très-techniques.html#des-formats-exotiques"><i class="fa fa-check"></i><b>20.2.1</b> des formats exotiques</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="annexes-quelques-problèmes-très-techniques.html"><a href="annexes-quelques-problèmes-très-techniques.html#adopter-des-formats-propres-tidy"><i class="fa fa-check"></i><b>20.3</b> Adopter des formats “propres” (tidy)</a></li>
<li class="chapter" data-level="20.4" data-path="annexes-quelques-problèmes-très-techniques.html"><a href="annexes-quelques-problèmes-très-techniques.html#les-limites-du-calcul"><i class="fa fa-check"></i><b>20.4</b> Les limites du calcul</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="etudes-de-cas.html"><a href="etudes-de-cas.html"><i class="fa fa-check"></i><b>21</b> Etudes de cas</a><ul>
<li class="chapter" data-level="21.1" data-path="etudes-de-cas.html"><a href="etudes-de-cas.html#sommaire"><i class="fa fa-check"></i><b>21.1</b> Sommaire</a><ul>
<li class="chapter" data-level="21.1.1" data-path="etudes-de-cas.html"><a href="etudes-de-cas.html#cas-1"><i class="fa fa-check"></i><b>21.1.1</b> Cas 1</a></li>
<li class="chapter" data-level="21.1.2" data-path="etudes-de-cas.html"><a href="etudes-de-cas.html#cas-2"><i class="fa fa-check"></i><b>21.1.2</b> Cas 2</a></li>
<li class="chapter" data-level="21.1.3" data-path="etudes-de-cas.html"><a href="etudes-de-cas.html#cas-3"><i class="fa fa-check"></i><b>21.1.3</b> Cas 3</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">NLP avec r et en français - un Manuel synthétique</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="machine-learning-supervisé-et-nlp" class="section level1">
<h1><span class="header-section-number">Chapitre 17</span> Machine learning supervisé et NLP</h1>
<p>les techniques de machine learning supervisées ont pour but de trouver une fonction f qui associe une variable y, à un ensemble de variables x. Leur évaluation se fait en examinant la qualité de prédiction sur un échantillon nouveau.</p>
<p><img src="images/ml01.JPG" /></p>
<div id="le-principe-et-ses-applications" class="section level2">
<h2><span class="header-section-number">17.1</span> Le principe et ses applications</h2>
<p>Les méthodes de machine learning, notamment celles qu’on appele classificateurs, peuvent être utile pour résoudre des problèmes de prédiction d’une variable à partir du contenu textuel.</p>
<p>L’exemple évident est quand on veut prédire la note à partir de commentaire du consommateur. Dans le même domaine on peut désirer connaitre ce qui détermine l’utilité d’un tel commentaire. Pour des données sociales on s’intéressera par exemple à la popularité d’un tweet. Et dans des usages plus sophistiqués on peut imaginer construire des catégories spécifiques , par exemple le caractère phatique ou nom d’un contenu, le ton employé. Dans ce cas, il faudra au préalable annoter manuellement un échantillon de ces contenus pour développer le classificateur et l’employer opérationnnement pour le codage de l’ensemble du corpus.</p>
<p>e processus va se dérouler selon les étapes suivantes</p>
<p>1 - on constitue les corpus de donnée. Un fichier d’entrainement et un de test.
2 - Le fichier d’entrainement est labellisé, etiqueté, annoté. Ce sont des termes équivalents qui désignent un processus plus ou moins objectif qui qualifie une chaine de caractère. Cette annotation peut être exogène ou endogène. Une annotation endogène est un jugement sur le contenu qui doit être annoté. Contient-il des élément toxiques ou non ?</p>
<p>Tel tweet est positif, tel autre ne l’est pas, tel tweets proteste, tel autre informe. Telle chaine de caractère est associée à un nombre de retweet élevé, tel autre à un nombre bas.
2 - on nettoie le texte, on limite les signes candidats</p>
<p>inspiré de <a href="https://www.hvitfeldt.me/blog/binary-text-classification-with-tidytext-and-caret/" class="uri">https://www.hvitfeldt.me/blog/binary-text-classification-with-tidytext-and-caret/</a></p>
</div>
<div id="une-première-application" class="section level2">
<h2><span class="header-section-number">17.2</span> Une première application</h2>
<p>Dans cette analyse, l’objectif va être de comprendre quel sont les mots, ou les expressions, qui sont determinent la popularité des tweets de Trump.</p>
<p>L’objectif va être de prédire à partir des termes, les chances qu’un tweet soit largement retwitté, et de comprendre quels sont les éléments qui contribuent le plus à expliquer la qualité des prédictions.</p>
<p>On va employer <code>caret</code>, qui est un cadre général pour mener des projets de machine-learning, et de <code>tidytext</code> pour manipuler le corpus de tweets.</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb209-1" title="1"><span class="co">#library(caret)</span></a>
<a class="sourceLine" id="cb209-2" title="2"></a>
<a class="sourceLine" id="cb209-3" title="3"></a>
<a class="sourceLine" id="cb209-4" title="4">df&lt;-<span class="kw">read.csv</span>(<span class="st">&quot;./data/TrumpTwitterArchive01-08-2021.csv&quot;</span>)</a>
<a class="sourceLine" id="cb209-5" title="5">df<span class="op">$</span>Year&lt;-<span class="kw">str_sub</span>(df<span class="op">$</span>date,<span class="dv">1</span>,<span class="dv">4</span>)</a></code></pre></div>
<div id="constituer-le-dataset" class="section level3">
<h3><span class="header-section-number">17.2.1</span> Constituer le dataset</h3>
<p>On prend les données du mandat (après 2016) pour ne pas mettre de confusion et rester dans un domaine homogène. (On peut déjà envisager une extension en jouant du temps, et en répétant l’analyse selon une fenêtre de temps - on reste dans le code statique)</p>
<p>On classe les tweets en deux catégories : ceux avec beaucoups de retweets et ceux qui en on moins. On prend le critère de la médiane pour avoir des annotations équilibrées. On envisagera plus tard ue approche en terme de régression. La dichotomisation est ici une première approche, un première approximation.</p>
<p>On choisit de se concentrer sur la période présidentielle pour que le nombre de followers soit à peu près constant.</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb210-1" title="1"><span class="co">#sélection du corpus</span></a>
<a class="sourceLine" id="cb210-2" title="2">data&lt;-df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb210-3" title="3"><span class="st">  </span><span class="kw">select</span>(text, retweets,Year) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb210-4" title="4"><span class="st">  </span><span class="kw">filter</span>(Year<span class="op">&gt;</span><span class="dv">2018</span>)</a>
<a class="sourceLine" id="cb210-5" title="5"></a>
<a class="sourceLine" id="cb210-6" title="6"><span class="co">#calcul de la mediane du nombre de retweets</span></a>
<a class="sourceLine" id="cb210-7" title="7"></a>
<a class="sourceLine" id="cb210-8" title="8">median&lt;-<span class="kw">round</span>(<span class="kw">median</span>(data<span class="op">$</span>retweets),<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb210-9" title="9"></a>
<a class="sourceLine" id="cb210-10" title="10"><span class="co"># codage des tweets au dessus et en dessous de la médiane</span></a>
<a class="sourceLine" id="cb210-11" title="11">data&lt;-data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb210-12" title="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">retweets_cl=</span><span class="kw">ifelse</span>(retweets<span class="op">&gt;</span>median, <span class="st">&quot;yes&quot;</span>,<span class="st">&quot;no&quot;</span>))</a>
<a class="sourceLine" id="cb210-13" title="13"></a>
<a class="sourceLine" id="cb210-14" title="14"><span class="co">#représentatio de la distribution</span></a>
<a class="sourceLine" id="cb210-15" title="15"><span class="kw">ggplot</span>(data, <span class="kw">aes</span>(retweets))<span class="op">+</span></a>
<a class="sourceLine" id="cb210-16" title="16"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">0.1</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb210-17" title="17"><span class="st">  </span><span class="kw">theme_minimal</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb210-18" title="18"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="kw">paste0</span>(<span class="st">&quot;médiane = &quot;</span>,median))<span class="op">+</span></a>
<a class="sourceLine" id="cb210-19" title="19"><span class="st">  </span><span class="kw">scale_x_log10</span>()</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/1202-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb211-1" title="1">data<span class="op">$</span>id&lt;-<span class="kw">row.names</span>(data) </a>
<a class="sourceLine" id="cb211-2" title="2"></a>
<a class="sourceLine" id="cb211-3" title="3"><span class="kw">ggplot</span>(data, <span class="kw">aes</span>(retweets_cl))<span class="op">+</span><span class="kw">geom_bar</span>()</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/1202-2.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="on-va-nettoyer-le-texte" class="section level3">
<h3><span class="header-section-number">17.2.2</span> On va nettoyer le texte</h3>
<ul>
<li>supprimer les liens</li>
<li>identifier les ngrams</li>
<li>éliminer des stopword</li>
<li>éliminer les termes utilisés moins de k fois (ce sera 20)</li>
<li>on crée un tableau dfm en calculant les tf-idf ( on pondère la préquence d’un terme par l’inverse de la fréquence des documents dans lesquels il apparait)</li>
<li></li>
</ul>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb212-1" title="1"><span class="co">#nettoyage des données</span></a>
<a class="sourceLine" id="cb212-2" title="2"><span class="co">##les liens</span></a>
<a class="sourceLine" id="cb212-3" title="3"></a>
<a class="sourceLine" id="cb212-4" title="4">data_clean &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb212-5" title="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">top =</span> retweets_cl,</a>
<a class="sourceLine" id="cb212-6" title="6">         <span class="dt">text =</span> <span class="kw">str_replace_all</span>(text, <span class="st">&quot; ?(f|ht)tp(s?)://(.*)[.][a-z]+&quot;</span>, <span class="st">&quot;&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb212-7" title="7"><span class="st">  </span><span class="kw">select</span>(id, top, text)</a>
<a class="sourceLine" id="cb212-8" title="8"></a>
<a class="sourceLine" id="cb212-9" title="9"></a>
<a class="sourceLine" id="cb212-10" title="10"><span class="co">## les stop_word</span></a>
<a class="sourceLine" id="cb212-11" title="11"></a>
<a class="sourceLine" id="cb212-12" title="12">data_counts &lt;-<span class="st"> </span><span class="kw">map_df</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,</a>
<a class="sourceLine" id="cb212-13" title="13">                      <span class="op">~</span><span class="st"> </span><span class="kw">unnest_tokens</span>(data_clean, word, text, </a>
<a class="sourceLine" id="cb212-14" title="14">                                      <span class="dt">token =</span> <span class="st">&quot;ngrams&quot;</span>, <span class="dt">n =</span> .x)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb212-15" title="15"><span class="st">  </span><span class="kw">anti_join</span>(stop_words, <span class="dt">by =</span> <span class="st">&quot;word&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb212-16" title="16"><span class="st">  </span><span class="kw">count</span>(id, word, <span class="dt">sort =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb212-17" title="17"></a>
<a class="sourceLine" id="cb212-18" title="18"></a>
<a class="sourceLine" id="cb212-19" title="19"><span class="co">## mots assez frequents</span></a>
<a class="sourceLine" id="cb212-20" title="20">words_<span class="dv">10</span> &lt;-<span class="st"> </span>data_counts <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb212-21" title="21"><span class="st">  </span><span class="kw">group_by</span>(word) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb212-22" title="22"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb212-23" title="23"><span class="st">  </span><span class="kw">filter</span>(n <span class="op">&gt;=</span><span class="st"> </span><span class="dv">30</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb212-24" title="24"><span class="st">  </span><span class="kw">select</span>(word)<span class="op">%&gt;%</span><span class="kw">drop_na</span>()</a>
<a class="sourceLine" id="cb212-25" title="25"></a>
<a class="sourceLine" id="cb212-26" title="26"><span class="co">#we will right-join this to our data.frame before we will calculate the tf_idf and cast it to a document term matrix.</span></a>
<a class="sourceLine" id="cb212-27" title="27"></a>
<a class="sourceLine" id="cb212-28" title="28">data_dtm &lt;-<span class="st"> </span>data_counts <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb212-29" title="29"><span class="st">  </span><span class="kw">right_join</span>(words_<span class="dv">10</span>, <span class="dt">by =</span> <span class="st">&quot;word&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb212-30" title="30"><span class="st">  </span><span class="kw">bind_tf_idf</span>(word, id, n) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb212-31" title="31"><span class="st">  </span><span class="kw">cast_dtm</span>(id, word, tf_idf)</a>
<a class="sourceLine" id="cb212-32" title="32"></a>
<a class="sourceLine" id="cb212-33" title="33"></a>
<a class="sourceLine" id="cb212-34" title="34"><span class="co">#We create this meta data.frame which acts as a intermediate from our first data set since some tweets might have disappeared completely after the reduction.</span></a>
<a class="sourceLine" id="cb212-35" title="35"></a>
<a class="sourceLine" id="cb212-36" title="36">meta &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">id =</span> <span class="kw">as.character</span>(<span class="kw">dimnames</span>(data_dtm)[[<span class="dv">1</span>]])) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb212-37" title="37"><span class="st">  </span><span class="kw">left_join</span>(data_clean[<span class="op">!</span><span class="kw">duplicated</span>(data_clean<span class="op">$</span>id), ], <span class="dt">by =</span> <span class="st">&quot;id&quot;</span>)</a></code></pre></div>
</div>
<div id="caret-sur-la-scène" class="section level3">
<h3><span class="header-section-number">17.2.3</span> caret sur la scène</h3>
<p>On commence à employer les fonction de <code>caret</code> qui permettent de distinguer les sets d’entrainement et de test, mais aussi, de tester l’efficacité des combinaisons d’hyper-paramètres propres à chaque modèle. <code>Caret</code> donne accès à plusieurs dizaienes de modèles différents. Voir : xxx</p>
<p>Nous allons tester trois types de modèles classiques : un naive bayes qui est le classique de la classification textuelle, un simple réseau de neurones. nnet. et un outil très populaire de Random forest.</p>
<p>les données du processus d’apprentissage. Le corpus est partitionné en un corpus d’entrainement et un corpus de texte.Le processus d’apprentissage est controllé par une méthode de crossvalidation en trois blocs.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb213-1" title="1">trainIndex &lt;-<span class="st"> </span><span class="kw">createDataPartition</span>(meta<span class="op">$</span>top, <span class="dt">p =</span> <span class="fl">0.7</span>, <span class="dt">list =</span> <span class="ot">FALSE</span>, <span class="dt">times =</span> <span class="dv">1</span>) <span class="co">#on partitionne</span></a>
<a class="sourceLine" id="cb213-2" title="2">data_df_train &lt;-<span class="st"> </span>data_dtm[trainIndex, ] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.matrix</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.data.frame</span>() <span class="co">#on definit le training set</span></a>
<a class="sourceLine" id="cb213-3" title="3">data_df_test &lt;-<span class="st"> </span>data_dtm[<span class="op">-</span>trainIndex, ] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.matrix</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.data.frame</span>() <span class="co">#on définit le test set</span></a>
<a class="sourceLine" id="cb213-4" title="4"></a>
<a class="sourceLine" id="cb213-5" title="5">response_train &lt;-<span class="st"> </span>meta<span class="op">$</span>top[trainIndex] <span class="co">#on définit l&#39;annotation</span></a>
<a class="sourceLine" id="cb213-6" title="6"></a>
<a class="sourceLine" id="cb213-7" title="7">trctrl &lt;-<span class="st"> </span><span class="kw">trainControl</span>(<span class="dt">method =</span> <span class="st">&quot;cv&quot;</span>,<span class="dv">5</span>, <span class="dt">classProbs=</span><span class="ot">TRUE</span>, <span class="dt">savePredictions =</span> <span class="ot">TRUE</span>) <span class="co"># on définit la stratégie d&#39;entrainement. Ici on utilise une méthode de cross validation fondée sur un découpage en 5 échantillons. </span></a></code></pre></div>
</div>
<div id="un-modèle-naive-bayes" class="section level3">
<h3><span class="header-section-number">17.2.4</span> Un modèle naive bayes</h3>
<p>Le modèle naive bayes est populaire car simple. Il calcule une probabilité conditionnelle : celle d’avoir un succès (s) en fonction d’une série de n termes <span class="math inline">\(t_{i}\)</span> .</p>
<p><span class="math display">\[p(S\mid t_{1},...,t_{n}) =p(S)\frac{p(t_{1},...,t_{n}\mid S)}{p(t_{1},...,t_{n})} \]</span>
On retrouve la très classique équation de Bayes. En faisant l’hypothèse de l’indépendance des probabilités conditionnelles, et en négligeant le numérateur, elle se simplifie sous la forme suivante. <span class="math inline">\(c\)</span> est une constante d’échelle, et la probabilité a priori d’être un succès est pondérée par le produit des probabilité conditionnelle d’observer le terme <span class="math inline">\(t_{i}\)</span> sachant que le tweet est un succès.</p>
<p><span class="math display">\[p(S\mid t_{1},...,t_{n}) =\frac{1}{c}p(S) \prod_{x = i}^{n} p(t_{i}\mid S)\]</span></p>
<p>On entraine le modèle avec un <a href="">lissage de Laplace</a>[<a href="https://towardsdatascience.com/laplace-smoothing-in-na%C3%AFve-bayes-algorithm-9c237a8bdece" class="uri">https://towardsdatascience.com/laplace-smoothing-in-na%C3%AFve-bayes-algorithm-9c237a8bdece</a>) pour éviter le problème des probabilités nulles qui résultent du fait qu’un mot, peut ne pas appartenir à l’ensemble d’entrainement.</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb214-1" title="1">nb_mod &lt;-<span class="st"> </span><span class="kw">train</span>(<span class="dt">x =</span> data_df_train,</a>
<a class="sourceLine" id="cb214-2" title="2">                <span class="dt">y =</span> <span class="kw">as.factor</span>(response_train),</a>
<a class="sourceLine" id="cb214-3" title="3">                <span class="dt">method =</span> <span class="st">&quot;naive_bayes&quot;</span>,</a>
<a class="sourceLine" id="cb214-4" title="4">                <span class="dt">trControl =</span> trctrl,</a>
<a class="sourceLine" id="cb214-5" title="5">                <span class="dt">tuneGrid =</span> <span class="kw">data.frame</span>(<span class="dt">laplace =</span> <span class="dv">1</span>,       </a>
<a class="sourceLine" id="cb214-6" title="6">                                      <span class="dt">usekernel =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb214-7" title="7">                                      <span class="dt">adjust =</span> <span class="ot">FALSE</span>))</a>
<a class="sourceLine" id="cb214-8" title="8">nb_mod</a></code></pre></div>
<pre><code>## Naive Bayes 
## 
## 13173 samples
##  2861 predictor
##     2 classes: &#39;no&#39;, &#39;yes&#39; 
## 
## No pre-processing
## Resampling: Cross-Validated (5 fold) 
## Summary of sample sizes: 10538, 10538, 10540, 10538, 10538 
## Resampling results:
## 
##   Accuracy  Kappa    
##   0.590676  0.1823724
## 
## Tuning parameter &#39;laplace&#39; was held constant at a value of 1
## Tuning
##  parameter &#39;usekernel&#39; was held constant at a value of FALSE
## Tuning
##  parameter &#39;adjust&#39; was held constant at a value of FALSE</code></pre>
<p>Examinons les résultats. La précision est de 0.59, autrement dit on prédit correctement les succès et les échecs dans 59% des cas, une prédiction aléatoire est de 50%, compte-tenu du caractère bien balancé de notre échantillon d’apprentissage. L’indice kappa est un indice de concordance qui compare la répartition des classes par rapport à une répartition aléatoire. Sa valeur ici est plutôt faible.</p>
<p>la qualité interne n’est pas suffisante, on va donc évaluer le modèle ( ou clafficateur) en prédisant les valeurs sur de l’échantillon test.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb216-1" title="1"><span class="kw">library</span>(MLeval)</a>
<a class="sourceLine" id="cb216-2" title="2">nb_mod<span class="op">$</span>results</a></code></pre></div>
<pre><code>##   laplace usekernel adjust Accuracy     Kappa  AccuracySD    KappaSD
## 1       1     FALSE  FALSE 0.590676 0.1823724 0.009527536 0.01920404</code></pre>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb218-1" title="1">nb_pred &lt;-<span class="st"> </span><span class="kw">predict</span>(nb_mod,</a>
<a class="sourceLine" id="cb218-2" title="2">                   <span class="dt">newdata =</span> data_df_test, <span class="dt">prob=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb218-3" title="3">nb_cm &lt;-<span class="st"> </span><span class="kw">confusionMatrix</span>(nb_pred, <span class="kw">as.factor</span>(meta[<span class="op">-</span>trainIndex, ]<span class="op">$</span>top))</a>
<a class="sourceLine" id="cb218-4" title="4">nb_cm</a></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction   no  yes
##        no  1495  887
##        yes 1352 1911
##                                           
##                Accuracy : 0.6034          
##                  95% CI : (0.5905, 0.6162)
##     No Information Rate : 0.5043          
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
##                                           
##                   Kappa : 0.2078          
##                                           
##  Mcnemar&#39;s Test P-Value : &lt; 2.2e-16       
##                                           
##             Sensitivity : 0.5251          
##             Specificity : 0.6830          
##          Pos Pred Value : 0.6276          
##          Neg Pred Value : 0.5857          
##              Prevalence : 0.5043          
##          Detection Rate : 0.2648          
##    Detection Prevalence : 0.4220          
##       Balanced Accuracy : 0.6041          
##                                           
##        &#39;Positive&#39; Class : no              
## </code></pre>
<p>Pour être concrêt pensons aux tests covid. Ils peuvent rendre compte de la présence du virus à raison, ce sont les vrais positifs et symétriquement rendre compte de l’absence de trace virale: les vrais négatifs. Ce sont les prédictions correctes. Les prédictions incorrecte sont de deux types : dans le premier on annonce une contamination alors qu’il n’y en a pas : ce sont les faux positifs. Ils alertent sans raison et peuvent obliger un sujet sain à s’isoler. Leurs symétriques sont les faux négatifs : ils annoncent que le virus est absent alors qu’il est tapi dans nos cellules. Les deux erreurs n’ont pas le même poids : la première génère de fausses peurs, la seconde la maladie.</p>
<p>Les indicateurs de qualité du modèle sont calculés à partir du tableau de contingence suivant.</p>
<pre><code>         Réalité 
         Echec    Succès</code></pre>
<p>Prédiction<br />
Echec TN FP
Succès FN TP</p>
<ul>
<li>la précision (accuracy) représentent le % de bonnes prédictions : Accuracy=TP+TN/TP+TN+FP+FN.</li>
<li>le recall ( ousensibility) : TPR=TP/TP+FN (sensitivity/ recall)</li>
<li>TNR=TN/TN+FP (specificity)</li>
<li>PPV=TP/TP+FP (precision/ positive predictive value)</li>
<li>NPV=TN/TN+FN (negative predictive value)</li>
<li>Informedness=TPR+TNR-1</li>
<li>Markedness=PPV+NPV-1</li>
</ul>
</div>
</div>
<div id="passons-à-un-réseau-de-neurones-et-un-rf" class="section level2">
<h2><span class="header-section-number">17.3</span> Passons à un réseau de neurones et un RF</h2>
<div id="neuralnetwook" class="section level3">
<h3><span class="header-section-number">17.3.1</span> neuralnetwook</h3>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb221-1" title="1"><span class="co">##rdf</span></a>
<a class="sourceLine" id="cb221-2" title="2">trctrl &lt;-<span class="st"> </span><span class="kw">trainControl</span>(<span class="dt">method =</span> <span class="st">&quot;cv&quot;</span>, <span class="dv">3</span>,<span class="dt">classProbs=</span><span class="ot">TRUE</span>, <span class="dt">savePredictions =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb221-3" title="3">model_grid &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(</a>
<a class="sourceLine" id="cb221-4" title="4">   <span class="dt">mtry =</span> <span class="dv">20</span>                                    <span class="co"># mtry specified here</span></a>
<a class="sourceLine" id="cb221-5" title="5">   ,<span class="dt">splitrule =</span> <span class="st">&quot;gini&quot;</span></a>
<a class="sourceLine" id="cb221-6" title="6">   ,<span class="dt">min.node.size =</span> <span class="dv">20</span></a>
<a class="sourceLine" id="cb221-7" title="7"> )</a>
<a class="sourceLine" id="cb221-8" title="8"></a>
<a class="sourceLine" id="cb221-9" title="9">ranger_mod &lt;-<span class="st"> </span><span class="kw">train</span>(<span class="dt">x =</span> data_df_train,</a>
<a class="sourceLine" id="cb221-10" title="10">                    <span class="dt">y =</span> <span class="kw">as.factor</span>(response_train),</a>
<a class="sourceLine" id="cb221-11" title="11">                    <span class="dt">method =</span> <span class="st">&quot;ranger&quot;</span>,</a>
<a class="sourceLine" id="cb221-12" title="12">                    <span class="dt">trControl =</span> trctrl,<span class="dt">tuneGrid =</span> model_grid,</a>
<a class="sourceLine" id="cb221-13" title="13">                    <span class="dt">importance=</span><span class="st">&quot;impurity&quot;</span>)</a></code></pre></div>
<pre><code>## Growing trees.. Progress: 77%. Estimated remaining time: 9 seconds.
## Growing trees.. Progress: 79%. Estimated remaining time: 8 seconds.
## Growing trees.. Progress: 78%. Estimated remaining time: 8 seconds.
## Growing trees.. Progress: 45%. Estimated remaining time: 38 seconds.
## Growing trees.. Progress: 90%. Estimated remaining time: 7 seconds.</code></pre>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb223-1" title="1">ranger_mod<span class="op">$</span>results</a></code></pre></div>
<pre><code>##   mtry splitrule min.node.size  Accuracy     Kappa  AccuracySD     KappaSD
## 1   20      gini            20 0.7736274 0.5473507 0.004963747 0.009983572</code></pre>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb225-1" title="1">ranger_pred &lt;-<span class="st"> </span><span class="kw">predict</span>(ranger_mod,</a>
<a class="sourceLine" id="cb225-2" title="2">                     <span class="dt">newdata =</span> data_df_test, <span class="dt">prob=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb225-3" title="3">ranger_cm &lt;-<span class="st"> </span><span class="kw">confusionMatrix</span>(ranger_pred, <span class="kw">as.factor</span>(meta[<span class="op">-</span>trainIndex, ]<span class="op">$</span>top))</a>
<a class="sourceLine" id="cb225-4" title="4">ranger_cm</a></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction   no  yes
##        no  2160  602
##        yes  687 2196
##                                           
##                Accuracy : 0.7717          
##                  95% CI : (0.7605, 0.7826)
##     No Information Rate : 0.5043          
##     P-Value [Acc &gt; NIR] : &lt;2e-16          
##                                           
##                   Kappa : 0.5434          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.0193          
##                                           
##             Sensitivity : 0.7587          
##             Specificity : 0.7848          
##          Pos Pred Value : 0.7820          
##          Neg Pred Value : 0.7617          
##              Prevalence : 0.5043          
##          Detection Rate : 0.3826          
##    Detection Prevalence : 0.4893          
##       Balanced Accuracy : 0.7718          
##                                           
##        &#39;Positive&#39; Class : no              
## </code></pre>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb227-1" title="1"><span class="co">##nn</span></a>
<a class="sourceLine" id="cb227-2" title="2">trctrl &lt;-<span class="st"> </span><span class="kw">trainControl</span>(<span class="dt">method =</span> <span class="st">&quot;cv&quot;</span>, <span class="dv">3</span>,<span class="dt">classProbs=</span><span class="ot">TRUE</span>, <span class="dt">savePredictions =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb227-3" title="3"></a>
<a class="sourceLine" id="cb227-4" title="4">nnet_mod &lt;-<span class="st"> </span><span class="kw">train</span>(<span class="dt">x =</span> data_df_train,</a>
<a class="sourceLine" id="cb227-5" title="5">                    <span class="dt">y =</span> <span class="kw">as.factor</span>(response_train),</a>
<a class="sourceLine" id="cb227-6" title="6">                    <span class="dt">method =</span> <span class="st">&quot;nnet&quot;</span>,</a>
<a class="sourceLine" id="cb227-7" title="7">                    <span class="dt">trControl =</span> trctrl,</a>
<a class="sourceLine" id="cb227-8" title="8">                    <span class="dt">tuneGrid =</span> <span class="kw">data.frame</span>(<span class="dt">size =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb227-9" title="9">                                          <span class="dt">decay =</span> <span class="fl">0.001</span>),</a>
<a class="sourceLine" id="cb227-10" title="10">                    <span class="dt">MaxNWts =</span> <span class="dv">15000</span>, <span class="dt">importance=</span><span class="st">&quot;impurity&quot;</span>)</a></code></pre></div>
<pre><code>## # weights:  5727
## initial  value 6086.832098 
## iter  10 value 4855.369927
## iter  20 value 2714.999332
## iter  30 value 1775.499366
## iter  40 value 1273.561893
## iter  50 value 1195.517310
## iter  60 value 1192.218838
## final  value 1192.140529 
## converged
## # weights:  5727
## initial  value 6129.967996 
## iter  10 value 5132.545643
## iter  20 value 3719.348736
## iter  30 value 2855.019956
## iter  40 value 2570.482580
## iter  50 value 2522.260816
## iter  60 value 2499.140878
## iter  70 value 2498.881386
## final  value 2498.881254 
## converged
## # weights:  5727
## initial  value 6131.686218 
## iter  10 value 4646.609610
## iter  20 value 2723.294710
## iter  30 value 1899.420740
## iter  40 value 1577.941905
## iter  50 value 1521.020919
## iter  60 value 1512.500626
## final  value 1512.452240 
## converged
## # weights:  5727
## initial  value 9152.610137 
## iter  10 value 7097.677365
## iter  20 value 5285.177736
## iter  30 value 4691.774838
## iter  40 value 4525.816007
## iter  50 value 4464.819728
## iter  60 value 4421.308453
## iter  70 value 4368.612887
## iter  80 value 4338.603137
## iter  90 value 4299.181041
## iter 100 value 4283.654133
## final  value 4283.654133 
## stopped after 100 iterations</code></pre>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb229-1" title="1">nnet_pred &lt;-<span class="st"> </span><span class="kw">predict</span>(nnet_mod,</a>
<a class="sourceLine" id="cb229-2" title="2">                     <span class="dt">newdata =</span> data_df_test, <span class="dt">prob=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb229-3" title="3">nnet_cm &lt;-<span class="st"> </span><span class="kw">confusionMatrix</span>(nnet_pred, <span class="kw">as.factor</span>(meta[<span class="op">-</span>trainIndex, ]<span class="op">$</span>top))</a>
<a class="sourceLine" id="cb229-4" title="4">nnet_cm</a></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction   no  yes
##        no  2010  700
##        yes  837 2098
##                                           
##                Accuracy : 0.7277          
##                  95% CI : (0.7159, 0.7393)
##     No Information Rate : 0.5043          
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
##                                           
##                   Kappa : 0.4556          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.0005224       
##                                           
##             Sensitivity : 0.7060          
##             Specificity : 0.7498          
##          Pos Pred Value : 0.7417          
##          Neg Pred Value : 0.7148          
##              Prevalence : 0.5043          
##          Detection Rate : 0.3561          
##    Detection Prevalence : 0.4801          
##       Balanced Accuracy : 0.7279          
##                                           
##        &#39;Positive&#39; Class : no              
## </code></pre>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb231-1" title="1"><span class="co">#nnet_mod$finalModel</span></a></code></pre></div>
</div>
<div id="multilayer" class="section level3">
<h3><span class="header-section-number">17.3.2</span> multilayer</h3>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb232-1" title="1">trctrl &lt;-<span class="st"> </span><span class="kw">trainControl</span>(<span class="dt">method =</span> <span class="st">&quot;cv&quot;</span>, <span class="dv">3</span> ,<span class="dt">classProbs =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb232-2" title="2"></a>
<a class="sourceLine" id="cb232-3" title="3">neuralGrid &lt;-<span class="kw">expand.grid</span>(</a>
<a class="sourceLine" id="cb232-4" title="4">  <span class="dt">layer1 =</span> <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb232-5" title="5">  <span class="dt">layer2 =</span> <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb232-6" title="6">  <span class="dt">layer3 =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb232-7" title="7">  <span class="dt">decay=</span><span class="fl">0.0005</span></a>
<a class="sourceLine" id="cb232-8" title="8">)</a>
<a class="sourceLine" id="cb232-9" title="9">neural_mod &lt;-<span class="st"> </span><span class="kw">train</span>(<span class="dt">x=</span>data_df_train,<span class="dt">y =</span> response_train,</a>
<a class="sourceLine" id="cb232-10" title="10">    <span class="dt">method =</span> <span class="st">&quot;mlpWeightDecayML&quot;</span>,</a>
<a class="sourceLine" id="cb232-11" title="11">    <span class="dt">tuneGrid =</span> neuralGrid, <span class="co"># cannot pass parameter hidden directly!!</span></a>
<a class="sourceLine" id="cb232-12" title="12">    <span class="dt">trControl =</span> <span class="kw">trainControl</span>(<span class="dt">method =</span> <span class="st">&quot;none&quot;</span>))</a>
<a class="sourceLine" id="cb232-13" title="13">    </a>
<a class="sourceLine" id="cb232-14" title="14">neural_pred &lt;-<span class="st"> </span><span class="kw">predict</span>(neural_mod,</a>
<a class="sourceLine" id="cb232-15" title="15">                     <span class="dt">newdata =</span> data_df_test, <span class="dt">prob=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb232-16" title="16">neural_cm &lt;-<span class="st"> </span><span class="kw">confusionMatrix</span>(neural_pred, <span class="kw">as.factor</span>(meta[<span class="op">-</span>trainIndex, ]<span class="op">$</span>top))</a>
<a class="sourceLine" id="cb232-17" title="17">neural_cm</a></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction   no  yes
##        no  2847 2798
##        yes    0    0
##                                           
##                Accuracy : 0.5043          
##                  95% CI : (0.4912, 0.5175)
##     No Information Rate : 0.5043          
##     P-Value [Acc &gt; NIR] : 0.5053          
##                                           
##                   Kappa : 0               
##                                           
##  Mcnemar&#39;s Test P-Value : &lt;2e-16          
##                                           
##             Sensitivity : 1.0000          
##             Specificity : 0.0000          
##          Pos Pred Value : 0.5043          
##          Neg Pred Value :    NaN          
##              Prevalence : 0.5043          
##          Detection Rate : 0.5043          
##    Detection Prevalence : 1.0000          
##       Balanced Accuracy : 0.5000          
##                                           
##        &#39;Positive&#39; Class : no              
## </code></pre>
</div>
</div>
<div id="comparons-les-modèles" class="section level2">
<h2><span class="header-section-number">17.4</span> Comparons les modèles</h2>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb234-1" title="1"><span class="co">#comparaison des modèles</span></a>
<a class="sourceLine" id="cb234-2" title="2"></a>
<a class="sourceLine" id="cb234-3" title="3">mod_results &lt;-<span class="st"> </span><span class="kw">rbind</span>(</a>
<a class="sourceLine" id="cb234-4" title="4">  nb_cm<span class="op">$</span>overall,</a>
<a class="sourceLine" id="cb234-5" title="5">  nnet_cm<span class="op">$</span>overall,</a>
<a class="sourceLine" id="cb234-6" title="6">  ranger_cm<span class="op">$</span>overall</a>
<a class="sourceLine" id="cb234-7" title="7">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb234-8" title="8"><span class="st">  </span><span class="kw">as.data.frame</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb234-9" title="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">model =</span> <span class="kw">c</span>(<span class="st">&quot;Naive-Bayes&quot;</span>, <span class="st">&quot;Neural network&quot;</span>,<span class="st">&quot;RF&quot;</span>))</a>
<a class="sourceLine" id="cb234-10" title="10"></a>
<a class="sourceLine" id="cb234-11" title="11">mod_results <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb234-12" title="12"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(model, Accuracy)) <span class="op">+</span></a>
<a class="sourceLine" id="cb234-13" title="13"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb234-14" title="14"><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb234-15" title="15"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> mod_results<span class="op">$</span>AccuracyNull[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb234-16" title="16">             <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/1210-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div id="une-analyse-plus-précise-de-la-performance" class="section level3">
<h3><span class="header-section-number">17.4.1</span> Une analyse plus précise de la performance</h3>
<p><a href="https://rvprasad.medium.com/informedness-and-markedness-20e3f54d63bc" class="uri">https://rvprasad.medium.com/informedness-and-markedness-20e3f54d63bc</a></p>
<p>avec <code>MLeval</code> qui fournit 4 graphes</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb235-1" title="1"><span class="kw">library</span>(plotROC)</a>
<a class="sourceLine" id="cb235-2" title="2"><span class="kw">library</span>(MLeval)</a>
<a class="sourceLine" id="cb235-3" title="3"></a>
<a class="sourceLine" id="cb235-4" title="4"></a>
<a class="sourceLine" id="cb235-5" title="5">res &lt;-<span class="st"> </span><span class="kw">evalm</span>(<span class="kw">list</span>(nnet_mod,nb_mod, ranger_mod),<span class="dt">gnames=</span><span class="kw">c</span>(<span class="st">&#39;nn&#39;</span>,<span class="st">&#39;nb&#39;</span>, <span class="st">&#39;rf&#39;</span>))</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/1211-1.png" width="80%" style="display: block; margin: auto;" /><img src="bookdown-demo_files/figure-html/1211-2.png" width="80%" style="display: block; margin: auto;" /><img src="bookdown-demo_files/figure-html/1211-3.png" width="80%" style="display: block; margin: auto;" /><img src="bookdown-demo_files/figure-html/1211-4.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="mais-il-faut-expliquer" class="section level2">
<h2><span class="header-section-number">17.5</span> Mais il faut expliquer</h2>
<p>Prédire est une chose, encore faut-il pouvoir expliquer. Les spécialistes du machines learning ont développé des outils à cette fin L’un entre eux est vip</p>
<p>Un principe général est d’examiner comment le modèle se comporte si on enlève la variable, quel sera l’accroissement de l’erreur. Une variable qui contribue fortement risque d’affecter fortement ce paramètre. En prenant les variables une à une ont peut alors établir leur importance relative.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb236-1" title="1"><span class="co">#explication</span></a>
<a class="sourceLine" id="cb236-2" title="2"><span class="kw">library</span>(vip)</a>
<a class="sourceLine" id="cb236-3" title="3"></a>
<a class="sourceLine" id="cb236-4" title="4">vip1&lt;-<span class="kw">vip</span>(nnet_mod, <span class="dt">num_features =</span> <span class="dv">40</span>, <span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">horizontal =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb236-5" title="5">    <span class="dt">aesthetics =</span> <span class="kw">list</span>(<span class="dt">color =</span> <span class="st">&quot;firebrick&quot;</span>, <span class="dt">shape =</span> <span class="dv">1</span>, <span class="dt">size =</span> <span class="dv">3</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb236-6" title="6"><span class="st">  </span><span class="kw">theme_minimal</span>()</a>
<a class="sourceLine" id="cb236-7" title="7">vip1</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/1212-1.png" width="672" /></p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb237-1" title="1">vip3&lt;-<span class="kw">vip</span>(ranger_mod, <span class="dt">num_features =</span> <span class="dv">40</span>, <span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">horizontal =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb237-2" title="2">    <span class="dt">aesthetics =</span> <span class="kw">list</span>(<span class="dt">color =</span> <span class="st">&quot;firebrick&quot;</span>, <span class="dt">shape =</span> <span class="dv">1</span>, <span class="dt">size =</span> <span class="dv">3</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb237-3" title="3"><span class="st">  </span><span class="kw">theme_minimal</span>()</a>
<a class="sourceLine" id="cb237-4" title="4">vip3</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/1212-2.png" width="672" /></p>
</div>
<div id="pour-finir-un-exercice-de-fine-tuning" class="section level2">
<h2><span class="header-section-number">17.6</span> Pour finir un exercice de fine tuning</h2>
<p>Si un modèle est bon, peut il être encore meilleur ? Oui si on en contrôle les hyperparamètres par une grille de valeurs.
Avec le modèle nnet on peut jouer sur le nombre d’unités cachées, et de taux de decay.</p>
<p>Attention ca peut être time intensive (plus d’une dizaine d’heures pour le code suivant sans parallélisation). On essaye d’accélerer le processus avec le package <code>doParallel</code> qui va répartir les calculs sur 3 des 4 processeurs de la machine (On en garde un pour l’OS).</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb238-1" title="1">t1&lt;-<span class="kw">Sys.time</span>()</a>
<a class="sourceLine" id="cb238-2" title="2">t1</a>
<a class="sourceLine" id="cb238-3" title="3"><span class="kw">library</span>(doParallel)</a>
<a class="sourceLine" id="cb238-4" title="4">cl &lt;-<span class="st"> </span><span class="kw">makePSOCKcluster</span>(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb238-5" title="5"><span class="kw">registerDoParallel</span>(cl)</a>
<a class="sourceLine" id="cb238-6" title="6"></a>
<a class="sourceLine" id="cb238-7" title="7"><span class="co">#tuning</span></a>
<a class="sourceLine" id="cb238-8" title="8"></a>
<a class="sourceLine" id="cb238-9" title="9">trctrl &lt;-<span class="st"> </span><span class="kw">trainControl</span>(<span class="dt">method =</span> <span class="st">&quot;cv&quot;</span>, <span class="dv">5</span>,<span class="dt">classProbs =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb238-10" title="10"></a>
<a class="sourceLine" id="cb238-11" title="11"><span class="co">#grille de paramètres</span></a>
<a class="sourceLine" id="cb238-12" title="12"></a>
<a class="sourceLine" id="cb238-13" title="13">nnetGrid &lt;-<span class="st">  </span><span class="kw">expand.grid</span>(<span class="dt">size =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">4</span>, <span class="dt">by =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb238-14" title="14">                        <span class="dt">decay =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">0.003</span>, <span class="dt">to =</span> <span class="fl">0.030</span>, <span class="dt">by =</span> <span class="fl">0.002</span>))</a>
<a class="sourceLine" id="cb238-15" title="15"><span class="co">#train </span></a>
<a class="sourceLine" id="cb238-16" title="16">nnet_mod_t &lt;-<span class="st"> </span><span class="kw">train</span>(<span class="dt">x=</span>data_df_train,</a>
<a class="sourceLine" id="cb238-17" title="17">                   <span class="dt">y =</span> response_train,</a>
<a class="sourceLine" id="cb238-18" title="18">                    <span class="dt">method =</span> <span class="st">&quot;nnet&quot;</span>,</a>
<a class="sourceLine" id="cb238-19" title="19">                    <span class="dt">trControl =</span> trctrl, <span class="dt">tuneGrid=</span>nnetGrid, <span class="dt">MaxNWts =</span> <span class="dv">10000</span>)</a>
<a class="sourceLine" id="cb238-20" title="20"><span class="kw">plot</span>(nnet_mod_t)</a>
<a class="sourceLine" id="cb238-21" title="21"><span class="kw">stopCluster</span>(cl)</a>
<a class="sourceLine" id="cb238-22" title="22">t2&lt;-<span class="kw">Sys.time</span>()</a>
<a class="sourceLine" id="cb238-23" title="23">t2<span class="op">-</span>t1</a></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="topic.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="deep-learning.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/16-ML-with-text.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
